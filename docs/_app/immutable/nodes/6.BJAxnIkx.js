import{s as x,o as ee,n as W}from"../chunks/w_vi9pvy.js";import{S as te,i as le,d as p,q as se,r as ne,u as ae,o as R,b as r,a as A,v as oe,c as m,n as re,f as g,e as y,g as w,h as G,p as M,w as ie,j as b,s as C,t as j,x as ce,y as Z,z as N,A as J}from"../chunks/BHN_rrvk.js";import{a as de,e as $}from"../chunks/D05DKe3s.js";import{G as ue}from"../chunks/CbFDBsou.js";const he=!0,Pe=Object.freeze(Object.defineProperty({__proto__:null,prerender:he},Symbol.toStringTag,{value:"Module"}));function K(i,t,s){const e=i.slice();e[6]=t[s],e[12]=s;const l=e[0][e[6].id];e[7]=l;const n=be(e[6],e[7]);e[8]=n;const o=e[1].has(e[6].id);e[9]=o;const h=e[2][e[6].id];return e[10]=h,e}function Q(i,t,s){const e=i.slice();e[13]=t[s];const l=e[7][e[13].id]||0;e[14]=l;const n=e[7].percentages[e[13].id]||0;e[15]=n;const o=e[8]&&e[8].id===e[13].id;return e[16]=o,e}function fe(i){let t,s=$(i[3]),e=[];for(let l=0;l<s.length;l+=1)e[l]=Y(K(i,s,l));return{c(){t=b("div");for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){t=g(l,"DIV",{class:!0});var n=w(t);for(let o=0;o<e.length;o+=1)e[o].l(n);n.forEach(p),this.h()},h(){m(t,"class","polls-list svelte-12dkk2z")},m(l,n){A(l,t,n);for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(t,null)},p(l,n){if(n&15){s=$(l[3]);let o;for(o=0;o<s.length;o+=1){const h=K(l,s,o);e[o]?e[o].p(h,n):(e[o]=Y(h),e[o].c(),e[o].m(t,null))}for(;o<e.length;o+=1)e[o].d(1);e.length=s.length}},d(l){l&&p(t),Z(e,l)}}}function ve(i){let t,s="No completed polls yet.";return{c(){t=b("p"),t.textContent=s,this.h()},l(e){t=g(e,"P",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-1a5adz4"&&(t.textContent=s),this.h()},h(){m(t,"class","empty-message svelte-12dkk2z")},m(e,l){A(e,t,l)},p:W,d(e){e&&p(t)}}}function _e(i){let t,s,e,l=i[7].total+"",n,o,h=$(i[6].options),d=[];for(let a=0;a<h.length;a+=1)d[a]=X(Q(i,h,a));return{c(){t=b("div");for(let a=0;a<d.length;a+=1)d[a].c();s=C(),e=b("p"),n=j(l),o=j(" total votes"),this.h()},l(a){t=g(a,"DIV",{class:!0});var v=w(t);for(let k=0;k<d.length;k+=1)d[k].l(v);s=y(v),e=g(v,"P",{class:!0});var c=w(e);n=M(c,l),o=M(c," total votes"),c.forEach(p),v.forEach(p),this.h()},h(){m(e,"class","results-total svelte-12dkk2z"),m(t,"class","poll-results svelte-12dkk2z")},m(a,v){A(a,t,v);for(let c=0;c<d.length;c+=1)d[c]&&d[c].m(t,null);r(t,s),r(t,e),r(e,n),r(e,o)},p(a,v){if(v&9){h=$(a[6].options);let c;for(c=0;c<h.length;c+=1){const k=Q(a,h,c);d[c]?d[c].p(k,v):(d[c]=X(k),d[c].c(),d[c].m(t,s))}for(;c<d.length;c+=1)d[c].d(1);d.length=h.length}v&9&&l!==(l=a[7].total+"")&&R(n,l)},d(a){a&&p(t),Z(d,a)}}}function pe(i){let t,s="Failed to load results";return{c(){t=b("div"),t.textContent=s,this.h()},l(e){t=g(e,"DIV",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-zeu5wd"&&(t.textContent=s),this.h()},h(){m(t,"class","error-message svelte-12dkk2z")},m(e,l){A(e,t,l)},p:W,d(e){e&&p(t)}}}function ke(i){let t,s='<span class="loading-text svelte-12dkk2z">Loading...</span>';return{c(){t=b("div"),t.innerHTML=s,this.h()},l(e){t=g(e,"DIV",{class:!0,"data-svelte-h":!0}),G(t)!=="svelte-1x7ljox"&&(t.innerHTML=s),this.h()},h(){m(t,"class","loading-container svelte-12dkk2z")},m(e,l){A(e,t,l)},p:W,d(e){e&&p(t)}}}function X(i){let t,s,e,l=i[13].label+"",n,o,h,d=i[14]+"",a,v,c=i[15]+"",k,V,S,E,_;return{c(){t=b("div"),s=b("div"),e=b("span"),n=j(l),o=C(),h=b("span"),a=j(d),v=j(" votes ("),k=j(c),V=j("%)"),S=C(),E=b("div"),_=b("div"),this.h()},l(u){t=g(u,"DIV",{class:!0});var f=w(t);s=g(f,"DIV",{class:!0});var I=w(s);e=g(I,"SPAN",{class:!0});var D=w(e);n=M(D,l),D.forEach(p),o=y(I),h=g(I,"SPAN",{class:!0});var P=w(h);a=M(P,d),v=M(P," votes ("),k=M(P,c),V=M(P,"%)"),P.forEach(p),I.forEach(p),S=y(f),E=g(f,"DIV",{class:!0});var O=w(E);_=g(O,"DIV",{class:!0,style:!0}),w(_).forEach(p),O.forEach(p),f.forEach(p),this.h()},h(){m(e,"class","result-label svelte-12dkk2z"),N(e,"winner-label",i[16]),m(h,"class","result-stats svelte-12dkk2z"),m(s,"class","result-info svelte-12dkk2z"),m(_,"class","result-bar svelte-12dkk2z"),J(_,"width",i[15]+"%"),N(_,"winner-bar",i[16]),m(E,"class","result-bar-container svelte-12dkk2z"),m(t,"class","result-row svelte-12dkk2z"),N(t,"winner",i[16])},m(u,f){A(u,t,f),r(t,s),r(s,e),r(e,n),r(s,o),r(s,h),r(h,a),r(h,v),r(h,k),r(h,V),r(t,S),r(t,E),r(E,_)},p(u,f){f&8&&l!==(l=u[13].label+"")&&R(n,l),f&9&&N(e,"winner-label",u[16]),f&9&&d!==(d=u[14]+"")&&R(a,d),f&9&&c!==(c=u[15]+"")&&R(k,c),f&9&&J(_,"width",u[15]+"%"),f&9&&N(_,"winner-bar",u[16]),f&9&&N(t,"winner",u[16])},d(u){u&&p(t)}}}function Y(i){let t,s,e,l,n,o=i[3].length-i[12]+"",h,d,a=i[6].question+"",v,c,k,V;function S(u,f){if(u[9])return ke;if(u[10])return pe;if(u[7])return _e}let E=S(i),_=E&&E(i);return{c(){t=b("div"),s=b("div"),e=b("span"),l=C(),n=b("h3"),h=j(o),d=j(". "),v=j(a),c=C(),k=b("div"),_&&_.c(),V=C(),this.h()},l(u){t=g(u,"DIV",{class:!0});var f=w(t);s=g(f,"DIV",{class:!0});var I=w(s);e=g(I,"SPAN",{class:!0}),w(e).forEach(p),l=y(I),n=g(I,"H3",{class:!0});var D=w(n);h=M(D,o),d=M(D,". "),v=M(D,a),D.forEach(p),I.forEach(p),c=y(f),k=g(f,"DIV",{class:!0});var P=w(k);_&&_.l(P),P.forEach(p),V=y(f),f.forEach(p),this.h()},h(){m(e,"class","svelte-12dkk2z"),m(n,"class","poll-question svelte-12dkk2z"),m(s,"class","poll-header svelte-12dkk2z"),m(k,"class","poll-content svelte-12dkk2z"),m(t,"class","poll-card svelte-12dkk2z")},m(u,f){A(u,t,f),r(t,s),r(s,e),r(s,l),r(s,n),r(n,h),r(n,d),r(n,v),r(t,c),r(t,k),_&&_.m(k,null),r(t,V)},p(u,f){f&8&&o!==(o=u[3].length-u[12]+"")&&R(h,o),f&8&&a!==(a=u[6].question+"")&&R(v,a),E===(E=S(u))&&_?_.p(u,f):(_&&_.d(1),_=E&&E(u),_&&(_.c(),_.m(k,null)))},d(u){u&&p(t),_&&_.d()}}}function me(i){let t,s,e,l,n,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="svelte-12dkk2z"><path d="M19 12H5M12 19l-7-7 7-7" class="svelte-12dkk2z"></path></svg>',h,d,a,v="Past Polls",c,k,V=i[3].length+"",S,E,_,u,f,I,D,P;function O(z,T){return z[3].length===0?ve:fe}let B=O(i),H=B(i);return D=new ue({}),{c(){t=b("meta"),s=C(),e=b("div"),l=b("div"),n=b("a"),n.innerHTML=o,h=C(),d=b("div"),a=b("h2"),a.textContent=v,c=C(),k=b("span"),S=j(V),E=j(" total"),_=C(),u=b("div"),f=C(),H.c(),I=C(),ce(D.$$.fragment),this.h()},l(z){const T=re("svelte-1toaffs",document.head);t=g(T,"META",{name:!0,content:!0,class:!0}),T.forEach(p),s=y(z),e=g(z,"DIV",{class:!0});var q=w(e);l=g(q,"DIV",{class:!0});var L=w(l);n=g(L,"A",{href:!0,class:!0,"aria-label":!0,"data-svelte-h":!0}),G(n)!=="svelte-ctxxn9"&&(n.innerHTML=o),h=y(L),d=g(L,"DIV",{class:!0});var F=w(d);a=g(F,"H2",{class:!0,"data-svelte-h":!0}),G(a)!=="svelte-18s61j2"&&(a.textContent=v),c=y(F),k=g(F,"SPAN",{class:!0});var U=w(k);S=M(U,V),E=M(U," total"),U.forEach(p),F.forEach(p),_=y(L),u=g(L,"DIV",{class:!0}),w(u).forEach(p),L.forEach(p),f=y(q),H.l(q),I=y(q),ie(D.$$.fragment,q),q.forEach(p),this.h()},h(){document.title="Past Polls - The Dles",m(t,"name","description"),m(t,"content","View results from past polls on The Dles."),m(t,"class","svelte-12dkk2z"),m(n,"href","/"),m(n,"class","back-arrow svelte-12dkk2z"),m(n,"aria-label","Go back home"),m(a,"class","polls-title svelte-12dkk2z"),m(k,"class","header-count svelte-12dkk2z"),m(d,"class","header-center svelte-12dkk2z"),m(u,"class","header-spacer svelte-12dkk2z"),m(l,"class","polls-header svelte-12dkk2z"),m(e,"class","polls-container svelte-12dkk2z")},m(z,T){r(document.head,t),A(z,s,T),A(z,e,T),r(e,l),r(l,n),r(l,h),r(l,d),r(d,a),r(d,c),r(d,k),r(k,S),r(k,E),r(l,_),r(l,u),r(e,f),H.m(e,null),r(e,I),oe(D,e,null),P=!0},p(z,[T]){(!P||T&8)&&V!==(V=z[3].length+"")&&R(S,V),B===(B=O(z))&&H?H.p(z,T):(H.d(1),H=B(z),H&&(H.c(),H.m(e,I)))},i(z){P||(ae(D.$$.fragment,z),P=!0)},o(z){ne(D.$$.fragment,z),P=!1},d(z){z&&(p(s),p(e)),p(t),H.d(),se(D)}}}function ge(i){const t=Object.values(i).reduce((e,l)=>e+l,0),s={};for(const[e,l]of Object.entries(i))s[e]=t>0?Math.round(l/t*100):0;return{...i,total:t,percentages:s}}function be(i,t){if(!t)return null;let s=0,e=[];for(const l of i.options){const n=t[l.id]||0;n>s?(s=n,e=[l]):n===s&&e.push(l)}return e.length===1?e[0]:null}function we(i,t,s){let e,l={},n=new Set,o={};const h={"poll-1":{yes:156,no:23},"poll-2":{yes:89,no:67},"poll-3":{yes:142,no:31},"poll-4":{"math-logic":78,words:94},"poll-5":{"yes-it-is-a-good-feature":45,"yes-but-i-dont-see-the-point":12,no:89},"poll-6":{music:112,"movies-tv":98},"poll-7":{sports:67,"video-games":134}};ee(()=>{e.forEach(a=>{d(a)})});async function d(a){n.add(a.id),s(1,n);try{const v=`/api/poll-results?pollId=${a.id}`,c=await fetch(v);if(!c.ok)throw new Error("Failed to load results");const k=await c.json();s(0,l[a.id]=ge(k.results),l),s(0,l)}catch(v){s(2,o[a.id]=v.message,o),s(2,o)}finally{n.delete(a.id),s(1,n)}}return s(3,e=de.filter(a=>{const v=new Date(a.timeRange.end);return new Date>v}).sort((a,v)=>new Date(v.timeRange.end)-new Date(a.timeRange.end))),[l,n,o,e]}class Ve extends te{constructor(t){super(),le(this,t,we,me,x,{})}}export{Ve as component,Pe as universal};
